<html>
<head>
<script src="socket.io.js"></script>
<script src="jquery.js"></script>
<script>
var socket = {};
function init() {
	socket = io.connect();

	socket.on('roundtime', function(time){
    	$('#clock').html(time.clock + '  ' + time.ms);
  	});

	printMatchList();
};

function printMatchList() {
	var jqxhr = $.ajax( "api/match" )
  	.done(function(data) {
  		var html = '';
    	for(var i in data) {
    		html += '<button onclick="getMatch(\'' + data[i]._id + '\')">Match ' + data[i]._id + '</button>'
    	}
    	$('#matchlist').html(html);
  	})
  	.fail(function() {
    	alert( "error" );
  	})
}

function createMatch() {
	var jqxhr = $.post( "api/match" )
  	.done(function(data) {
  		printMatchList();
  	})
  	.fail(function() {
    	alert( "error" );
  	})
}

function getMatch(id) {
	
	var jqxhr = $.ajax( "api/match/" + id)
  	.done(function(data) {
  		matchId = id;
  		socket.emit('join', {id:id});
  		$('#clock').html(data.roundTime.clock + '  ' + data.roundTime.ms);
  	})
  	.fail(function() {
    	alert( "error" );
  	})
};

function pauseResume() {
	var jqxhr = $.ajax( 'api/match/' + matchId + '/pauseresume' )
  	.done(function() {
  		
  	})
  	.fail(function() {
    	alert( "error" );
  	})
}

function socketPauseResume() {
	socket.emit('pauseresume', {id:matchId});
}


</script>
</head>
<body onload="init()">
<div id="clock">

</div>

<div id="matchlist">

</div>
<button onclick="pauseResume()">Pause / Resume</button>
<button onclick="socketPauseResume()">Pause / Resume via socket</button>
<button onclick="createMatch()">New Match</button>
</body>
</html>